<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Cooperativa Agr铆cola La Pintada</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'></text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/dashboard.css">
    <link rel="stylesheet" href="assets/css/creative-messages.css">
    <link rel="stylesheet" href="assets/css/reportes.css">
    <link rel="stylesheet" href="assets/css/dark-mode.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-seedling"></i>
                </div>
                <h1>Cooperativa La Pintada</h1>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <div class="nav-item active" data-section="dashboard">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" data-section="socios">
                <i class="fas fa-users"></i>
                <span>Socios</span>
            </div>
            <div class="nav-item" data-section="insumos">
                <i class="fas fa-seedling"></i>
                <span>Insumos</span>
            </div>
            <div class="nav-item" data-section="produccion">
                <i class="fas fa-chart-bar"></i>
                <span>Producci贸n</span>
            </div>
            <div class="nav-item" data-section="ventas">
                <i class="fas fa-shopping-cart"></i>
                <span>Ventas</span>
            </div>
            <div class="nav-item" data-section="pagos">
                <i class="fas fa-money-bill-wave"></i>
                <span>Pagos</span>
            </div>
            <div class="nav-item" data-section="reportes">
                <i class="fas fa-chart-pie"></i>
                <span>Reportes</span>
            </div>
        </nav>
        
        <div class="sidebar-footer">
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Cerrar Sesi贸n</span>
            </button>
        </div>
    </aside>

    <!-- Main Content Area -->
    <div class="main-wrapper">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo">
                        <div class="logo-icon">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <h1>Cooperativa La Pintada</h1>
                    </div>
                </div>
                <div class="header-right">
                    <div class="header-actions">
                        <button class="header-btn" id="notificationsBtn" title="Notificaciones">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge">3</span>
                        </button>
                        <button class="header-btn" id="messagesBtn" title="Mensajes">
                            <i class="fas fa-envelope"></i>
                            <span class="message-badge">2</span>
                        </button>
                    </div>
                    <div class="user-profile" id="userProfileBtn">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-details">
                            <div class="user-name" id="userName">Usuario</div>
                            <div class="user-role" id="userRole">Miembro</div>
                        </div>
                        <div class="user-profile-arrow">
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Loading -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Cargando dashboard...</p>
            </div>

            <!-- Dashboard Section -->
            <section class="content-section active" id="dashboardSection">
                <div class="dashboard-header">
                    <h2 id="welcomeTitle">隆Bienvenido a tu Cooperativa!</h2>
                    <p id="welcomeMessage">Gestiona tu cooperativa de manera eficiente y moderna</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalMembers">0</div>
                            <div class="stat-label">Miembros Activos</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalCrops">0</div>
                            <div class="stat-label">Cultivos Registrados</div>
                        </div>
                    </div>
                    <div class="stat-card stat-card-dark">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalRevenue">$0</div>
                            <div class="stat-label">Ingresos del Mes</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="pendingTasks">0</div>
                            <div class="stat-label">Tareas Pendientes</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Socios Section -->
            <section class="content-section" id="sociosSection">
                <div class="socios-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-users"></i>
                            Gesti贸n de Socios
                        </h2>
                        <div class="section-actions">
                            <input type="text" id="searchInput" class="search-input" placeholder="Buscar socios...">
                            <button class="btn btn-primary" id="addSocioBtn">
                                <i class="fas fa-plus"></i> Agregar Socio
                            </button>
                        </div>
                    </div>

                <div class="table-container">
                    <table class="table" id="sociosTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>C茅dula</th>
                                <th>Tel茅fono</th>
                                <th>Email</th>
                                <th>Estado</th>
                                <th>Aportes</th>
                                <th>Deudas</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="sociosTableBody">
                            <!-- Los datos se cargar谩n aqu铆 -->
                        </tbody>
                    </table>
                </div>

                    <div class="pagination" id="pagination">
                        <!-- La paginaci贸n se generar谩 aqu铆 -->
                    </div>
                </div>
            </section>

            <!-- Insumos Section -->
            <section class="content-section" id="insumosSection">
                <div class="insumos-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-seedling"></i>
                            Gesti贸n de Insumos
                        </h2>
                        <div class="section-actions">
                            <input type="text" id="searchInsumosInput" class="search-input" placeholder="Buscar insumos...">
                            <button class="btn btn-primary" id="addInsumoBtn">
                                <i class="fas fa-plus"></i> Agregar Insumo
                            </button>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="table" id="insumosTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Tipo</th>
                                    <th>Cant. Disponible</th>
                                    <th>Precio Unitario</th>
                                    <th>Proveedor</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="insumosTableBody">
                                <!-- Los datos se cargar谩n aqu铆 -->
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination" id="insumosPagination">
                        <!-- La paginaci贸n se generar谩 aqu铆 -->
                    </div>
                </div>
            </section>

            <!-- Producci贸n Section -->
            <section class="content-section" id="produccionSection">
                <div class="produccion-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-chart-bar"></i>
                            Gesti贸n de Producci贸n
                        </h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" id="addProduccionBtn">
                                <i class="fas fa-plus"></i> Registrar Producci贸n
                            </button>
                        </div>
                    </div>

                    <!-- Statistics Cards -->
                    <div class="stats-grid" id="produccionStatsGrid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="totalProduccion">0</div>
                                <div class="stat-label">Producci贸n Total</div>
                                <div class="stat-unit" id="totalProduccionUnit">quintales</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="cultivosActivos">0</div>
                                <div class="stat-label">Cultivos Activos</div>
                            </div>
                        </div>
                        <div class="stat-card stat-card-dark">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="productoresActivos">0</div>
                                <div class="stat-label">Productores Activos</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="calidadPremium">0%</div>
                                <div class="stat-label">Calidad Premium</div>
                            </div>
                        </div>
                    </div>

                    <div class="table-container">
                        <div class="table-header">
                            <h3>Registro de Producci贸n</h3>
                            <p>Historial de cosechas registradas por socio</p>
                        </div>
                        <table class="table" id="produccionTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Socio</th>
                                    <th>Cultivo</th>
                                    <th>Variedad</th>
                                    <th>Cantidad</th>
                                    <th>Fecha</th>
                                    <th>Calidad</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="produccionTableBody">
                                <!-- Los datos se cargar谩n aqu铆 -->
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination" id="produccionPagination">
                        <!-- La paginaci贸n se generar谩 aqu铆 -->
                    </div>
                </div>
            </section>

            <!-- Ventas Section -->
            <section class="content-section" id="ventasSection">
                <div class="ventas-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-shopping-cart"></i>
                            Gesti贸n de Ventas
                        </h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" id="addVentaBtn">
                                <i class="fas fa-plus"></i> Registrar Venta
                            </button>
                        </div>
                    </div>

                    <!-- Statistics Cards -->
                    <div class="stats-grid" id="ventasStatsGrid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="ventasTotales">$0</div>
                                <div class="stat-label">Ventas Totales</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="ventasPendientes">0</div>
                                <div class="stat-label">Ventas Pendientes</div>
                            </div>
                        </div>
                        <div class="stat-card stat-card-dark">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="ventasPagadas">0</div>
                                <div class="stat-label">Ventas Pagadas</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="clientesActivos">0</div>
                                <div class="stat-label">Clientes Activos</div>
                            </div>
                        </div>
                    </div>

                    <div class="table-container">
                        <div class="table-header">
                            <h3>Registro de Ventas</h3>
                            <p>Historial de ventas registradas por socio</p>
                        </div>
                        <table class="table" id="ventasTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Socio</th>
                                    <th>Producto</th>
                                    <th>Cliente</th>
                                    <th>Cantidad</th>
                                    <th>Precio Unit.</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="ventasTableBody">
                                <!-- Los datos se cargar谩n aqu铆 -->
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination" id="ventasPagination">
                        <!-- La paginaci贸n se generar谩 aqu铆 -->
                    </div>
                </div>
            </section>

            <!-- Pagos Section -->
            <section class="content-section" id="pagosSection">
                <div class="pagos-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-money-bill-wave"></i>
                            Gesti贸n de Pagos
                        </h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" id="addPagoBtn">
                                <i class="fas fa-plus"></i> Registrar Pago
                            </button>
                        </div>
                    </div>

                    <!-- Statistics Cards -->
                    <div class="stats-grid" id="pagosStatsGrid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="ingresosTotales">$0</div>
                                <div class="stat-label">Ingresos Totales</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="pagosPendientes">0</div>
                                <div class="stat-label">Pagos Pendientes</div>
                            </div>
                        </div>
                        <div class="stat-card stat-card-dark">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="pagosConfirmados">0</div>
                                <div class="stat-label">Pagos Confirmados</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="aportesMensuales">0</div>
                                <div class="stat-label">Aportes Mensuales</div>
                            </div>
                        </div>
                    </div>

                    <div class="table-container">
                        <div class="table-header">
                            <h3>Registro de Pagos</h3>
                            <p>Historial de pagos registrados por socio</p>
                        </div>
                        <table class="table" id="pagosTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Socio</th>
                                    <th>Tipo</th>
                                    <th>Descripci贸n</th>
                                    <th>Monto</th>
                                    <th>Fecha</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="pagosTableBody">
                                <!-- Los datos se cargar谩n aqu铆 -->
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination" id="pagosPagination">
                        <!-- La paginaci贸n se generar谩 aqu铆 -->
                    </div>
                </div>
            </section>

            <!-- Reportes Section -->
            <section class="content-section" id="reportesSection">
                <div class="reportes-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-chart-pie"></i>
                            Reportes y Estad铆sticas
                        </h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" id="goToReportsBtn">
                                <i class="fas fa-external-link-alt"></i> Ir a Reportes Completos
                            </button>
                        </div>
                    </div>

                    <div class="reportes-preview">
                        <div class="preview-cards">
                            <div class="preview-card">
                                <div class="preview-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="preview-content">
                                    <h3>Ventas Mensuales</h3>
                                    <div class="preview-value" id="previewSales">$28,000</div>
                                    <div class="preview-change positive">+12.5%</div>
                                </div>
                            </div>

                            <div class="preview-card">
                                <div class="preview-icon">
                                    <i class="fas fa-hand-holding-usd"></i>
                                </div>
                                <div class="preview-content">
                                    <h3>Aportes Recaudados</h3>
                                    <div class="preview-value" id="previewContributions">$16,800</div>
                                    <div class="preview-subtitle">124 miembros activos</div>
                                </div>
                            </div>

                            <div class="preview-card">
                                <div class="preview-icon">
                                    <i class="fas fa-boxes"></i>
                                </div>
                                <div class="preview-content">
                                    <h3>Valor de Inventario</h3>
                                    <div class="preview-value" id="previewInventory">$11,369</div>
                                    <div class="preview-subtitle">305 art铆culos</div>
                                </div>
                            </div>

                            <div class="preview-card">
                                <div class="preview-icon">
                                    <i class="fas fa-percentage"></i>
                                </div>
                                <div class="preview-content">
                                    <h3>Margen Bruto</h3>
                                    <div class="preview-value" id="previewMargin">62.5%</div>
                                    <div class="preview-subtitle">Rentabilidad</div>
                                </div>
                            </div>
                        </div>

                        <div class="preview-charts">
                            <div class="preview-chart">
                                <h4><i class="fas fa-chart-bar"></i> Evoluci贸n Financiera</h4>
                                <canvas id="previewFinancialChart"></canvas>
                            </div>
                            <div class="preview-chart">
                                <h4><i class="fas fa-pie-chart"></i> Inventario por Tipo</h4>
                                <canvas id="previewInventoryChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal para agregar/editar socio -->
    <div class="modal" id="socioModal">
        <div class="modal-content">
            <h3 id="modalTitle">Agregar Nuevo Socio</h3>
            <form id="socioForm">
                <input type="hidden" id="socioId" name="id_socio">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="nombre">Nombre Completo *</label>
                        <input type="text" id="nombre" name="nombre" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="cedula">C茅dula *</label>
                        <input type="text" id="cedula" name="cedula" class="form-control" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="telefono">Tel茅fono</label>
                        <input type="tel" id="telefono" name="telefono" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" class="form-control">
                    </div>
                </div>

                <div class="form-group">
                    <label for="direccion">Direcci贸n</label>
                    <textarea id="direccion" name="direccion" class="form-control" rows="2"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="fecha_ingreso">Fecha de Ingreso</label>
                        <input type="date" id="fecha_ingreso" name="fecha_ingreso" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="estado">Estado</label>
                        <select id="estado" name="estado" class="form-control">
                            <option value="activo">Activo</option>
                            <option value="inactivo">Inactivo</option>
                            <option value="suspendido">Suspendido</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="aportes_totales">Aportes Totales</label>
                        <input type="number" id="aportes_totales" name="aportes_totales" class="form-control" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label for="deudas_pendientes">Deudas Pendientes</label>
                        <input type="number" id="deudas_pendientes" name="deudas_pendientes" class="form-control" step="0.01" min="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="observaciones">Observaciones</label>
                    <textarea id="observaciones" name="observaciones" class="form-control" rows="3"></textarea>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveBtn">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para agregar/editar insumo -->
    <div class="modal" id="insumoModal">
        <div class="modal-content">
            <h3 id="insumoModalTitle">Agregar Nuevo Insumo</h3>
            <form id="insumoForm">
                <input type="hidden" id="insumoId" name="id_insumo">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="nombre_insumo">Nombre del Insumo *</label>
                        <input type="text" id="nombre_insumo" name="nombre_insumo" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="tipo">Tipo de Insumo *</label>
                        <select id="tipo" name="tipo" class="form-control" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="semillas">Semillas</option>
                            <option value="fertilizantes">Fertilizantes</option>
                            <option value="pesticidas">Pesticidas</option>
                            <option value="herramientas">Herramientas</option>
                            <option value="maquinaria">Maquinaria</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cantidad_disponible">Cantidad Disponible</label>
                        <input type="number" id="cantidad_disponible" name="cantidad_disponible" class="form-control" min="0" value="0">
                    </div>
                    <div class="form-group">
                        <label for="cantidad_minima">Cantidad M铆nima</label>
                        <input type="number" id="cantidad_minima" name="cantidad_minima" class="form-control" min="0" value="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="precio_unitario">Precio Unitario *</label>
                        <input type="number" id="precio_unitario" name="precio_unitario" class="form-control" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="proveedor">Proveedor</label>
                        <input type="text" id="proveedor" name="proveedor" class="form-control">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="fecha_registro">Fecha de Registro *</label>
                        <input type="date" id="fecha_registro" name="fecha_registro" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="ubicacion_almacen">Ubicaci贸n en Almac茅n</label>
                        <input type="text" id="ubicacion_almacen" name="ubicacion_almacen" class="form-control" placeholder="Ej: Almac茅n A - Estante 1">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="estado">Estado</label>
                        <select id="estado" name="estado" class="form-control">
                            <option value="disponible">Disponible</option>
                            <option value="agotado">Agotado</option>
                            <option value="descontinuado">Descontinuado</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="descripcion">Descripci贸n</label>
                    <textarea id="descripcion" name="descripcion" class="form-control" rows="3"></textarea>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" id="cancelInsumoBtn">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveInsumoBtn">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para agregar/editar producci贸n -->
    <div class="modal" id="produccionModal">
        <div class="modal-content">
            <h3 id="produccionModalTitle">Registrar Nueva Producci贸n</h3>
            <form id="produccionForm">
                <input type="hidden" id="produccionId" name="id_produccion">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="id_socio">Socio *</label>
                        <select id="id_socio" name="id_socio" class="form-control" required>
                            <option value="">Seleccionar socio</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cultivo">Cultivo *</label>
                        <input type="text" id="cultivo" name="cultivo" class="form-control" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="variedad">Variedad</label>
                        <input type="text" id="variedad" name="variedad" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="cantidad">Cantidad *</label>
                        <input type="number" id="cantidad" name="cantidad" class="form-control" step="0.01" min="0" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="unidad">Unidad *</label>
                        <select id="unidad" name="unidad" class="form-control" required>
                            <option value="quintales">Quintales</option>
                            <option value="toneladas">Toneladas</option>
                            <option value="libras">Libras</option>
                            <option value="sacos">Sacos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="area_cultivada">rea Cultivada (hect谩reas)</label>
                        <input type="number" id="area_cultivada" name="area_cultivada" class="form-control" step="0.01" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="fecha_siembra">Fecha de Siembra</label>
                        <input type="date" id="fecha_siembra" name="fecha_siembra" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="fecha_recoleccion">Fecha de Recolecci贸n *</label>
                        <input type="date" id="fecha_recoleccion" name="fecha_recoleccion" class="form-control" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="calidad">Calidad *</label>
                        <select id="calidad" name="calidad" class="form-control" required>
                            <option value="premium">Premium</option>
                            <option value="buena">Buena</option>
                            <option value="regular">Regular</option>
                            <option value="baja">Baja</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="precio_estimado">Precio Estimado</label>
                        <input type="number" id="precio_estimado" name="precio_estimado" class="form-control" step="0.01" min="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="observaciones">Observaciones</label>
                    <textarea id="observaciones" name="observaciones" class="form-control" rows="3"></textarea>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" id="cancelProduccionBtn">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveProduccionBtn">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para agregar/editar venta -->
    <div class="modal" id="ventaModal">
        <div class="modal-content">
            <h3 id="ventaModalTitle">Registrar Nueva Venta</h3>
            <form id="ventaForm">
                <input type="hidden" id="ventaId" name="id_venta">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="socioSelect">Socio *</label>
                        <select id="socioSelect" name="id_socio" class="form-control" required>
                            <option value="">Seleccionar socio</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="producto">Producto *</label>
                        <input type="text" id="producto" name="producto" class="form-control" placeholder="Nombre del producto" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cantidad">Cantidad *</label>
                        <input type="number" id="cantidad" name="cantidad" class="form-control" step="0.01" min="0" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label for="precio_unitario">Precio Unitario *</label>
                        <input type="number" id="precio_unitario" name="precio_unitario" class="form-control" step="0.01" min="0" placeholder="0.00" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cliente">Cliente *</label>
                        <input type="text" id="cliente" name="cliente" class="form-control" placeholder="Nombre del cliente" required>
                    </div>
                    <div class="form-group">
                        <label for="fecha_venta">Fecha de Venta *</label>
                        <input type="date" id="fecha_venta" name="fecha_venta" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="fecha_entrega">Fecha de Entrega</label>
                        <input type="date" id="fecha_entrega" name="fecha_entrega" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="estado">Estado</label>
                        <select id="estado" name="estado" class="form-control">
                            <option value="pendiente">Pendiente</option>
                            <option value="entregado">Entregado</option>
                            <option value="pagado">Pagado</option>
                            <option value="cancelado">Cancelado</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="metodo_pago">M茅todo de Pago</label>
                        <select id="metodo_pago" name="metodo_pago" class="form-control">
                            <option value="efectivo">Efectivo</option>
                            <option value="transferencia">Transferencia</option>
                            <option value="cheque">Cheque</option>
                            <option value="credito">Cr茅dito</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="direccion_entrega">Direcci贸n de Entrega</label>
                        <input type="text" id="direccion_entrega" name="direccion_entrega" class="form-control" placeholder="Direcci贸n completa">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="observaciones">Observaciones</label>
                    <textarea id="observaciones" name="observaciones" class="form-control" rows="3" placeholder="Notas adicionales..."></textarea>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" id="cancelVentaBtn">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveVentaBtn">Guardar Venta</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para agregar/editar pago -->
    <div class="modal" id="pagoModal">
        <div class="modal-content">
            <h3 id="pagoModalTitle">Registrar Nuevo Pago</h3>
            <form id="pagoForm">
                <input type="hidden" id="pagoId" name="id_pago">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="pagoSocioSelect">Socio *</label>
                        <select id="pagoSocioSelect" name="id_socio" class="form-control" required>
                            <option value="">Seleccionar socio</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tipo">Tipo de Pago *</label>
                        <select id="tipo" name="tipo" class="form-control" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="aporte_mensual">Aporte Mensual</option>
                            <option value="aporte_extraordinario">Aporte Extraordinario</option>
                            <option value="pago_venta">Pago de Venta</option>
                            <option value="prestamo">Pr茅stamo</option>
                            <option value="devolucion">Devoluci贸n</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="monto">Monto *</label>
                        <input type="number" id="monto" name="monto" class="form-control" step="0.01" min="0" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label for="fecha_pago">Fecha de Pago *</label>
                        <input type="date" id="fecha_pago" name="fecha_pago" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="metodo_pago">M茅todo de Pago</label>
                        <select id="metodo_pago" name="metodo_pago" class="form-control">
                            <option value="efectivo">Efectivo</option>
                            <option value="transferencia">Transferencia</option>
                            <option value="cheque">Cheque</option>
                            <option value="deposito">Dep贸sito</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="estado">Estado</label>
                        <select id="estado" name="estado" class="form-control">
                            <option value="pendiente">Pendiente</option>
                            <option value="confirmado">Confirmado</option>
                            <option value="rechazado">Rechazado</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="numero_comprobante">N煤mero de Comprobante</label>
                        <input type="text" id="numero_comprobante" name="numero_comprobante" class="form-control" placeholder="N煤mero de comprobante">
                    </div>
                    <div class="form-group">
                        <label for="id_venta">ID de Venta (opcional)</label>
                        <input type="number" id="id_venta" name="id_venta" class="form-control" placeholder="ID de venta relacionada">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="descripcion">Descripci贸n</label>
                    <textarea id="descripcion" name="descripcion" class="form-control" rows="3" placeholder="Descripci贸n del pago..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="observaciones">Observaciones</label>
                    <textarea id="observaciones" name="observaciones" class="form-control" rows="3" placeholder="Notas adicionales..."></textarea>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" id="cancelPagoBtn">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="savePagoBtn">Guardar Pago</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div class="modal" id="userProfileModal">
        <div class="modal-content user-profile-modal">
            <div class="modal-header">
                <h3><i class="fas fa-user-cog"></i> Mi Perfil</h3>
                <button class="close-btn" id="closeUserProfile">&times;</button>
            </div>
            
            <div class="user-profile-content">
                <!-- User Info Section -->
                <div class="profile-section">
                    <div class="profile-avatar-section">
                        <div class="profile-avatar-large" id="profileAvatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <h4 id="profileUserName">Usuario</h4>
                            <p class="user-role-badge" id="profileUserRole">Miembro</p>
                            <p class="user-email" id="profileUserEmail">usuario@cooperativa.com</p>
                            <p class="user-join-date" id="profileJoinDate">Miembro desde: 2022</p>
                            <p class="user-last-access" id="profileLastAccess">ltimo acceso: Hoy</p>
                        </div>
                        <button class="btn btn-outline btn-sm" id="changeAvatarBtn">
                            <i class="fas fa-camera"></i> Cambiar Foto
                        </button>
                    </div>
                </div>

                <!-- Personal Information Form -->
                <div class="profile-section">
                    <h4><i class="fas fa-user-edit"></i> Informaci贸n Personal</h4>
                    <form id="userProfileForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="firstName">Nombre Completo</label>
                                <input type="text" id="firstName" name="firstName" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Correo Electr贸nico</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Security Section -->
                <div class="profile-section">
                    <h4><i class="fas fa-shield-alt"></i> Seguridad</h4>
                    <div class="security-options">
                        <button class="btn btn-outline" id="changePasswordBtn">
                            <i class="fas fa-key"></i> Cambiar Contrase帽a
                        </button>
                    </div>
                </div>

                <!-- Preferences Section -->
                <div class="profile-section">
                    <h4><i class="fas fa-cog"></i> Preferencias</h4>
                    <div class="preferences-grid">
                        <div class="preference-item">
                            <label class="switch">
                                <input type="checkbox" id="emailNotifications" checked>
                                <span class="slider"></span>
                            </label>
                            <span>Notificaciones por Email</span>
                        </div>
                        
                        <div class="preference-item">
                            <label class="switch">
                                <input type="checkbox" id="darkMode">
                                <span class="slider"></span>
                            </label>
                            <span>Modo Oscuro</span>
                        </div>
                    </div>
                </div>

            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelUserProfile">Cancelar</button>
                <button class="btn btn-primary" id="saveUserProfile">
                    <i class="fas fa-save"></i> Guardar Cambios
                </button>
            </div>
        </div>
    </div>

    <!-- Logout Modal -->
    <div class="modal" id="logoutModal">
        <div class="modal-content">
            <h3>驴Cerrar Sesi贸n?</h3>
            <p>驴Est谩s seguro de que deseas cerrar tu sesi贸n?</p>
            <div class="modal-buttons">
                <button class="btn btn-primary" id="confirmLogout">S铆, Cerrar Sesi贸n</button>
                <button class="btn btn-secondary" id="cancelLogout">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <script src="assets/js/dashboard.js"></script>
    <script src="assets/js/dark-mode.js"></script>
    <script>
        // Inicializar modo oscuro al cargar la p谩gina
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar el gestor de modo oscuro
            if (typeof darkModeManager !== 'undefined') {
                darkModeManager.init();
            }
            
            // Inicializar el toggle del perfil de usuario
            initializeProfileDarkMode();
            
            // Event listener para abrir modal de perfil
            const userProfileBtn = document.getElementById('userProfileBtn');
            if (userProfileBtn) {
                userProfileBtn.addEventListener('click', function() {
                    const modal = document.getElementById('userProfileModal');
                    modal.style.display = 'flex';
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden'; // Prevenir scroll del body
                });
            }
            
            // Event listeners para cerrar modal de perfil
            const closeUserProfile = document.getElementById('closeUserProfile');
            const cancelUserProfile = document.getElementById('cancelUserProfile');
            
            if (closeUserProfile) {
                closeUserProfile.addEventListener('click', function() {
                    const modal = document.getElementById('userProfileModal');
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto'; // Restaurar scroll del body
                });
            }
            
            if (cancelUserProfile) {
                cancelUserProfile.addEventListener('click', function() {
                    const modal = document.getElementById('userProfileModal');
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto'; // Restaurar scroll del body
                });
            }
            
            // Event listener para guardar perfil
            const saveUserProfile = document.getElementById('saveUserProfile');
            if (saveUserProfile) {
                saveUserProfile.addEventListener('click', function() {
                    // Aqu铆 puedes agregar l贸gica para guardar las preferencias del usuario
                    showToast('Preferencias guardadas correctamente', 'success');
                    const modal = document.getElementById('userProfileModal');
                    modal.style.display = 'none';
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto'; // Restaurar scroll del body
                });
            }
            
            // Event listener para cambiar avatar
            const changeAvatarBtn = document.getElementById('changeAvatarBtn');
            if (changeAvatarBtn) {
                changeAvatarBtn.addEventListener('click', function() {
                    // Crear input de archivo oculto
                    const fileInput = document.createElement('input');
                    fileInput.type = 'file';
                    fileInput.accept = 'image/*';
                    fileInput.style.display = 'none';
                    
                    fileInput.addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                const profileAvatar = document.getElementById('profileAvatar');
                                profileAvatar.innerHTML = `<img src="${e.target.result}" alt="Avatar" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">`;
                                showToast('Foto de perfil actualizada', 'success');
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    
                    document.body.appendChild(fileInput);
                    fileInput.click();
                    document.body.removeChild(fileInput);
                });
            }
            
            // Event listener para cerrar modal al hacer clic en el overlay
            const userProfileModal = document.getElementById('userProfileModal');
            if (userProfileModal) {
                userProfileModal.addEventListener('click', function(e) {
                    if (e.target === userProfileModal) {
                        userProfileModal.style.display = 'none';
                        userProfileModal.classList.remove('show');
                        document.body.style.overflow = 'auto';
                    }
                });
            }
        });
        
        // Funci贸n para mostrar notificaciones toast
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            const container = document.getElementById('toastContainer');
            if (container) {
                container.appendChild(toast);
                
                // Mostrar toast
                setTimeout(() => {
                    toast.style.opacity = '1';
                    toast.style.transform = 'translateY(0)';
                }, 100);
                
                // Ocultar toast despu茅s de 3 segundos
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            }
        }
    </script>

    <!-- Modal de Cambio de Contrase帽a -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content user-profile-modal">
            <div class="modal-header">
                <h3><i class="fas fa-key"></i> Cambiar Contrase帽a</h3>
                <button class="close-btn" id="closeChangePassword">&times;</button>
            </div>
            
            <div class="user-profile-content">
                <!-- Formulario de Cambio de Contrase帽a -->
                <div class="profile-section">
                    <h4><i class="fas fa-shield-alt"></i> Seguridad de la Cuenta</h4>
                    <form id="changePasswordForm">
                        <div class="form-group">
                            <label for="currentPassword">Contrase帽a Actual</label>
                            <input type="password" id="currentPassword" name="currentPassword" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="newPassword">Nueva Contrase帽a</label>
                            <input type="password" id="newPassword" name="newPassword" class="form-control" required>
                            <small class="form-text">M铆nimo 8 caracteres, incluir letras y n煤meros</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword">Confirmar Nueva Contrase帽a</label>
                            <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
                        </div>
                    </form>
                </div>

                <!-- Informaci贸n de Seguridad -->
                <div class="profile-section">
                    <h4><i class="fas fa-info-circle"></i> Recomendaciones de Seguridad</h4>
                    <div class="security-tips">
                        <div class="tip-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Usa una combinaci贸n de letras may煤sculas y min煤sculas</span>
                        </div>
                        <div class="tip-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Incluye n煤meros y s铆mbolos especiales</span>
                        </div>
                        <div class="tip-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Evita informaci贸n personal obvia</span>
                        </div>
                        <div class="tip-item">
                            <i class="fas fa-check-circle"></i>
                            <span>No reutilices contrase帽as de otras cuentas</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelChangePassword">Cancelar</button>
                <button class="btn btn-primary" id="saveChangePassword">
                    <i class="fas fa-save"></i> Cambiar Contrase帽a
                </button>
            </div>
        </div>
    </div>

    <script>
        // Event listener para abrir modal de cambio de contrase帽a
        const changePasswordBtn = document.getElementById('changePasswordBtn');
        if (changePasswordBtn) {
            changePasswordBtn.addEventListener('click', function() {
                const modal = document.getElementById('changePasswordModal');
                modal.style.display = 'flex';
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            });
        }
        
        // Event listeners para cerrar modal de cambio de contrase帽a
        const closeChangePassword = document.getElementById('closeChangePassword');
        const cancelChangePassword = document.getElementById('cancelChangePassword');
        
        if (closeChangePassword) {
            closeChangePassword.addEventListener('click', function() {
                const modal = document.getElementById('changePasswordModal');
                modal.style.display = 'none';
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
            });
        }
        
        if (cancelChangePassword) {
            cancelChangePassword.addEventListener('click', function() {
                const modal = document.getElementById('changePasswordModal');
                modal.style.display = 'none';
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
            });
        }
        
        // Event listener para guardar cambio de contrase帽a
        const saveChangePassword = document.getElementById('saveChangePassword');
        if (saveChangePassword) {
            saveChangePassword.addEventListener('click', function() {
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                // Validaciones b谩sicas
                if (!currentPassword || !newPassword || !confirmPassword) {
                    showToast('Por favor, completa todos los campos', 'error');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    showToast('Las contrase帽as nuevas no coinciden', 'error');
                    return;
                }
                
                if (newPassword.length < 8) {
                    showToast('La nueva contrase帽a debe tener al menos 8 caracteres', 'error');
                    return;
                }
                
                // Aqu铆 puedes agregar l贸gica para cambiar la contrase帽a
                showToast('Contrase帽a cambiada correctamente', 'success');
                const modal = document.getElementById('changePasswordModal');
                modal.style.display = 'none';
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
                
                // Limpiar formulario
                document.getElementById('changePasswordForm').reset();
            });
        }
        
        // Event listener para cerrar modal al hacer clic en el overlay
        const changePasswordModal = document.getElementById('changePasswordModal');
        if (changePasswordModal) {
            changePasswordModal.addEventListener('click', function(e) {
                if (e.target === changePasswordModal) {
                    changePasswordModal.style.display = 'none';
                    changePasswordModal.classList.remove('show');
                    document.body.style.overflow = 'auto';
                }
            });
        }
    </script>
</body>
</html>
